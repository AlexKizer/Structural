window.S=function(){"use strict";var a={};return a.definitions={},a.define=function(b,c){console.info("Defining %s",c);var d=c.split("."),e=a.definitions;d.forEach(function(a){e[a]||((e[a]={}).value=null),e=e[a]}),e.value=b},a.get=function(b){if(!(b.indexOf("undefined")>-1)){var c=b.split("."),d=a.definitions;return c.forEach(function(a){d[a]||((d[a]={}).value=null),d=d[a]}),d.value}},a.component=function(b,c){return c?void a.defineComponent(b,c):a.instantiateComponent(b)},a.defineComponent=function(b,c){a.define(c,"components."+b)},a.instantiateComponent=function(b){return new a.get("components."+b)},a.method=function(b,c,d){var e="components."+d+".methods";a.get(e)||a.define([],e),a.get(e).push({name:c,func:b})},a.EventEmitter=function(){this.registeredEvents={}},a.EventEmitter.prototype.on=function(a,b){this.registeredEvents[a]||(this.registeredEvents[a]=[]),this.registeredEvents[a].push(b)},a.EventEmitter.prototype.fire=function(a,b){if(this.registeredEvents[a])for(var c=0;c<this.registeredEvents[a].length;c++)this.registeredEvents[a][c].call(b,b)},a.extend=function(){var a=Array.prototype.slice.call(arguments),b={};return a.forEach(function(a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])}),b},a.map=function(){var a={},b={},c=function(c,d){if("undefined"==typeof c.id)throw new Error("S.map() requires id property");return"undefined"==typeof d?(a[c.id]||(a[c.id]={}),a[c.id]):(a[c.id]=d,void(b[c.id]=c))};return c.clear=function(){a={},b={}},c.delete=function(b){if(!b.id)throw new Error("S.map() requires id property");delete a[b.id]},c.has=function(b){if(!b.id)throw new Error("S.map() requires id property");return"undefined"!=typeof a[b.id]},c.forEach=function(c,d){d||(d={});for(var e in a)c.call(d,[b[e],a[e]])},c},a.wait=function(a,b){setTimeout(a,b)},a}(),S.Component=function(a,b){a&&(this.state=a),b&&(this.view=b,this.view.state=this.state)},S.Component.prototype=Object.create(S.EventEmitter.prototype),S.Component.prototype.constructor=S.Component,Object.defineProperty(S.Component.prototype,"state",{get:function(){var a=this._state;return this.onGetState&&(a=this.onGetState(a)||a),a},set:function(a){var b=a;this.onSetState&&(b=this.onSetState(b)||b),this._state=b}}),S.View=function(a,b){this.$element=b instanceof jQuery?b:jQuery(b),this.state=a,this.interactive=!0},S.View.prototype=Object.create(S.EventEmitter.prototype),S.View.prototype.constructor=S.View,S.View.prototype.onResize=function(){},S.View.prototype.clear=function(){this.$element.empty()},S.View.prototype.enableInteractivity=function(){this.interactive=!0},S.View.prototype.disableInteractivity=function(){this.interactive=!1},S.AsyncFunctionQueue=function(){function a(){this.functionList=[],this.position=0,this.sleep=10,this.states=[],this._open=!1,this.clearOnFinish=!0,this.executing=!1}return a.prototype.push=function(a){this.functionList.push(a),this._open&&!this.executing&&this.exec()},a.prototype.clear=function(){this.executing=!1,this.functionList=[],this.position=0},a.prototype.next=function(a){var b=this;this.position>=this.functionList.length?a(!0):this.functionList[this.position].call(b,function(){b.position++,a()})},a.prototype.exec=function(){function a(){return b.position>=b.functionList.length&&b.clearOnFinish&&b.clear(),b.position>=b.functionList.length||!b.executing||!b.functionList[b.position]?(b.executing=!1,void console.groupEnd()):void b.next(function(){setTimeout(a,b.sleep)})}console.groupCollapsed("AsyncFunctionQueue executing"),this.executing=!0;var b=this;a()},a.prototype.pause=function(){this.executing=!1},a.prototype.open=function(){this._open=!0,this.exec()},a.prototype.close=function(){this._open=!1,this.executing=!1},Object.defineProperty(a.prototype,"length",{get:function(){return this.functionList.length}}),Object.defineProperty(a.prototype,"completion",{get:function(){return this.position/this.functionList.length}}),a}(),S.Deferred=function(){function a(a){var c=this;S.EventEmitter.call(this),this.queue=a,this.handle={},this.handle.standard=function(a,b){return"undefined"==typeof b?c.handle.standard._get(a):void c.handle.standard._set(a,b)},this.include(b(),b(),{name:"standard"})}function b(){var a={},b={};return a.flog=function(a,b){console.log(a),b&&b()},a.flog.live=!0,a.fwarn=function(a,b){console.warn(a),b&&b()},a.fwarn.live=!0,a._set=function(a,c,d){b[a]=c,d&&d()},a._set.live=!0,a._get=function(a,c){return c&&c(),b[a]},a._get.live=!0,a.comment=function(){},a.comment.live=!0,a}var c={};return a.prototype=Object.create(S.EventEmitter.prototype),a.prototype.include=function(a,b,d){var d=S.extend(c,d),e=this.handle[d.name||a]?this.handle[d.name||a]:this.handle[d.name||a]={},f=this,g=S.get("components."+a.alias+".methods");for(var h in a)"function"==typeof a[h]&&a[h].live&&(e[h]=function(c){var d=function(){var d=Array.prototype.slice.call(arguments);return f.queue.push(function(b){a[c].apply(a,d.concat(b))}),b[c].apply(b,d)};return d}(h));g&&0!=g.length&&g.forEach(function(a){e[a.name]||(e[a.name]=function(){var b=Array.prototype.slice.call(arguments);b.unshift(e),a.func.apply(f.handle.standard,b)})})},a}(),S.Array=function(){function a(a,b){this.alias="array",S.Component.call(this,a,b)}return a.prototype=Object.create(S.Component.prototype),a.prototype.constructor=a,a.prototype.onSetState=function(a){var b={};return b.array=[].concat(a.array),console.log("array.onSetState state.array is "),console.dir(b.array),b.flags=[],b},a.prototype.onGetState=function(a){return a},a.prototype.getLength=function(a){return console.log("getLength length is %s",this.state.array.length),console.dir(this.state.array),this.view?void a(this.state.array.length):this.state.array.length},a.prototype.getLength.live=!0,a.prototype.flag=function(a,b){this.state.flags[a]=!0,this.view&&this.view.flag(a,b)},a.prototype.flag.live=!0,a.prototype.flagged=function(){},a.prototype.flagged.true,a.prototype.setItem=function(a,b,c){this.state.array[a]=b,this.view&&this.view.setItem(a,b,c)},a.prototype.setItem.live=!0,a.prototype.getItem=function(a,b){return this.view?void b(this.state.array[a]):this.state.array[a]},a.prototype.getItem.live=!0,a.prototype.push=function(a,b){this.state.array.push(a),this.view&&this.view.push(a,b)},a.prototype.push.live=!0,a.prototype.focus=function(a,b){this.view&&this.view.focus(a,b)},a.prototype.focus.live=!0,a.prototype.range=function(a,b,c,d){this.view&&this.view.range(a,b,c,d)},a.prototype.range.live=!0,a.prototype.clearfocus=function(a){this.view&&this.view.clearfocus(a)},a.prototype.clearfocus.live=!0,a.prototype.clearrange=function(a,b){this.view&&this.view.clearrange(a,b)},a.prototype.clearrange.live=!0,a.prototype.leftTo=function(a,b){this.view&&this.view.leftTo(a,b)},a.prototype.leftTo.live=!0,a}(),S.ArrayView=function(){function a(a,b){S.View.call(this,a,b),this.options={hiddenDelimiter:",",numElements:5,pageTime:300,stepTime:50,scrollTime:500,maxScrollTime:1e3},this.leftBound=0,this.rightBound=this.options.numElements-1,this.$e=null,this.$table=null,this.$topRow=null,this.$bottomRow=null,this.$cells=$(),this.$indices=$(),this.computedWidth=null,this.width=null,this.border=0,this.computedCellWidth=null,this.height=null,this.$e=$('<div class="array"></div>'),this.scaleTo({width:this.$element.width(),height:this.$element.height()}),this.state&&this.render()}return a.prototype=Object.create(S.View.prototype),a.prototype.constructor=a,a.prototype.scaleTo=function(a){this.width=a.width,this.height=a.height,this.$e.css("width",a.width),this.$e.css("height",a.height),this.computedCellWidth=Math.floor(this.width/this.options.numElements)-this.border},a.prototype.render=function(){this.clear(),this.$cells=$(),this.$indices=$(),this.$table=$("<table></table>").addClass("array-table"),this.$topRow=$("<tr></tr>").addClass("array-top"),this.$bottomRow=$("<tr></tr>").addClass("array-bottom"),this.$e.append(this.$table),this.$table.append(this.$topRow).append(this.$bottomRow),this.$table.css({height:this.height}),this.$topRow.css({fontSize:Math.round(.25*this.$table.height())});for(var a=0;a<this.state.array.length;a++){var b=$("<td>"+this.state.array[a]+'<span style="font-size: 0;">'+this.options.hiddenDelimiter+"</span></td>"),c=$("<th>"+a+"</th>");b.data("index",a),c.data("index",a),b.width(this.computedCellWidth),c.width(this.computedCellWidth),b.addClass("array-cell"),c.addClass("array-index"),this.$topRow.append(b),this.$bottomRow.append(c),this.$cells=this.$cells.add(b),this.$indices=this.$indices.add(c)}this.computedWidth=this.computedCellWidth+this.border,this.width=this.options.numElements*this.computedWidth+this.border,this.$e.css("width",this.width),this.$element.append(this.$e),this.bindEvents(this.$cells,this.$indices)},a.prototype.bindEvents=function(){var a=this;this.$cells.click(function(){a.interactive&&a.focus($(this).data("index"))}),this.$cells.dblclick(function(){a.interactive&&($(this).hasClass("array-flagged")?$(this).removeClass("array-flagged"):$(this).addClass("array-flagged"))})},a.prototype.focus=function(a,b){if(!(0>a||a>this.state.array.length-1)){this.$cells.removeClass("focus"),this.$indices.removeClass("focus"),this.$cells.eq(a).addClass("focus"),this.$indices.eq(a).addClass("focus");var c=a-Math.floor(this.options.numElements/2);this.leftTo(c,b)}},a.prototype.focus.live=!0,a.prototype.clearfocus=function(a){this.$cells.removeClass("focus"),this.$indices.removeClass("focus"),a()},a.prototype.clearfocus.live=!0,a.prototype.flag=function(a,b){this.$cells.eq(a).addClass("array-flagged"),b&&b()},a.prototype.flag.live=!0,a.prototype.range=function(a,b,c,d){var e=this.$cells.slice(a,b+1),f="range"+c;e.addClass(function(a){var b=e.eq(a).attr("class"),c=f+" "+b;e.eq(a).attr("class",c)}),d()},a.prototype.range.live=!0,a.prototype.clearrange=function(a,b){this.$cells.removeClass("range"+a),b()},a.prototype.clearrange.live=!0,a.prototype.setItem=function(a,b,c){var d=this;this.focus(a,function(){S.wait(function(){d.$cells.eq(a).addClass("array-remove"),S.wait(function(){d.$cells.eq(a).text(b),d.$cells.eq(a).removeClass("array-remove"),c()},300)},200)})},a.prototype.setItem.live=!0,a.prototype.push=function(a,b){var c=this.addItem(a,this.state.array.length-1);this.leftTo(this.state.array.length-1,function(){c.animate({opacity:1},200,function(){b()})})},a.prototype.push.live=!0,a.prototype.addItem=function(a,b){var c=$("<td>"+a+"</td>"),d=$("<th>"+b+"</th>"),e=c.add(d).css({opacity:0,width:this.computedCellWidth});return c.addClass("array-cell"),d.addClass("array-index"),e.data("index",b),this.$topRow.append(c),this.$bottomRow.append(d),this.$cells=this.$cells.add(c),this.$indices=this.$indices.add(d),this.bindEvents(c,d),e},a.prototype.leftTo=function(a,b){if(a=parseInt(a,10),!isNaN(a)){0>=a&&(a=0),a>=this.state.array.length-1&&(a=this.state.array.length-1);var c=Math.min(Math.abs(a-this.leftBound)*this.options.stepTime,this.options.maxScrollTime);0==a?(this.leftBound=0,this.rightBound=this.options.numElements-1):a>this.state.array.length-this.options.numElements?(this.leftBound=this.state.array.length-this.options.numElements,this.rightBound=this.state.array.length-1):(this.leftBound=a,this.rightBound=a+this.options.numElements-1),this.scrollTo(a*this.computedWidth,c,b)}},a.prototype.rightTo=function(a){if(a=parseInt(a,10),!isNan(a)){0>=a&&(a=0),a>=this.state.array.length-1&&(a=this.state.array.length-1);var b=Math.min(Math.abs(a-this.leftBound)*this.options.stepTime,this.options.maxScrollTime);a<=this.options.numElements-1?(this.leftBound=0,this.rightBound=this.options.numElements-1):a==this.state.array.length-1?(this.leftBound=this.state.array.length-this.options.numElements,this.rightBound=this.state.array.length-1):(this.leftBound=a-this.options.numElements+1,this.rightBound=a),scrollTo(a*this.computedWidth,b)}},a.prototype.pageRight=function(){this.leftBound=this.leftBound+this.options.numElements<=this.state.array.length-this.options.numElements?this.leftBound+this.options.numElements:this.state.array.length-this.options.numElements,this.rightBound=this.rightBound+this.options.numElements<=this.state.array.length-1?this.rightBound+this.options.numElements:this.state.array.length-1,page(!0)},a.prototype.pageLeft=function(){this.leftBound=this.leftBound-this.options.numElements>=0?this.leftBound-this.options.numElements:0,this.rightBound=this.rightBound-this.options.numElements>=this.options.numElements-1?this.rightBound-this.options.numElements:this.options.numElements-1,page(!1)},a.prototype.right=function(){this.leftBound=this.leftBound+1<=this.state.array.length-this.options.numElements?this.leftBound+1:this.state.array.length-this.options.numElements,this.rightBound=this.rightBound+1<=this.state.array.length-1?this.rightBound+1:this.state.array.length-1,this.step(!0)},a.prototype.left=function(){this.leftBound=this.leftBound-1>=0?this.leftBound-1:0,this.rightBound=this.rightBound-1>=this.options.numElements-1?this.rightBound-1:this.options.numElements-1,this.step(!1)},a.prototype.page=function(a){this.scroll(a,this.options.pageTime,this.width-1)},a.prototype.step=function(a){this.scroll(a,this.options.stepTime,this.computedWidth)},a.prototype.scroll=function(a,b,c){var d="+=";a||(d="-=");var e={};e.scrollLeft=d+c,this.$e.animate(e,b)},a.prototype.scrollTo=function(a,b,c){this.$e.animate({scrollLeft:a},b,function(){"undefined"!=typeof c&&c()})},a}(),S.Tree=function(){function a(a,b){console.info("Calling tree constructor."),this.alias="tree",this.nodes={},S.Component.call(this,a,b)}return a.prototype=Object.create(S.Component.prototype),a.prototype.constructor=a,a.Node=function(a,b,c,d){this.value=a,this.id=b,this.left=c,this.right=d},a.prototype.onSetState=function(a){var b={};return b.nextId=a.nextId||0,b.root=this.copyTree(a.root,null),this.setNodeIds(b.root,b),this.computeHeights(b.root),b},a.prototype.onGetState=function(a){return a},a.prototype.root=function(a){return this.view?void a(this.state.root):this.state.root},a.prototype.root.live=!0,a.prototype.add=function(b,c,d,e){var f,g=this.nodes[b.id],h=c?"right":"left";return g[h]&&this.view?(console.log("Node already present."),e()):g[h]?void console.log("Node already present."):(f=g[h]=new a.Node(d,this.getNextNodeId(this.state),null,null),this.nodes[f.id]=f,this.computeHeights(this.state.root),this.view?void this.view.add(g,c,d,function(){e(f)}):f)},a.prototype.add.live=!0,a.prototype.remove=function(a,b){a=this.getNodeById(a);a.parent;a.parent&&a.parent.left==a?a.parent.left=null:a.parent&&a.parent.right==a&&(a.parent.right=null),this.computeHeights(this.state),this.view&&this.view.remove(a,b)},a.prototype.remove.live=!0,a.prototype.set=function(a,b,c){return a=this.getNodeById(a),a.value=b,this.view?void this.view.set(a,b,function(){c(a)}):a},a.prototype.set.live=!0,a.prototype.get=function(a,b){return a=this.getNodeById(a),this.view?void b(a.value):a.value},a.prototype.get.live=!0,a.prototype.height=function(a){return this.view&&a(this.computeHeights(this._state)),this.computeHeights(this._state)},a.prototype.height.live=!0,a.prototype.mark=function(a){this.view&&this.view.mark(a)},a.prototype.mark.live=!0,a.prototype.markPath=function(a){this.view&&this.view.markPath(a)},a.prototype.markPath.live=!0,a.prototype.clearPath=function(a){this.view&&this.view.clearPath(a)},a.prototype.clearPath.live=!0,a.prototype.clearLabels=function(a){this.view&&this.view.clearLabels(a)},a.prototype.clearLabels.live=!0,a.prototype.travel=function(a,b,c){console.log("Travelling!"),this.view&&this.view.travel(a,b,c)},a.prototype.travel.live=!0,a.prototype.label=function(a,b,c){this.view&&this.view.label(a,b,c)},a.prototype.label.live=!0,a.prototype.focus=function(a,b){this.view&&this.view.focus(a,b)},a.prototype.focus.live=!0,a.prototype.unfocus=function(a,b){this.view&&this.view.unfocus(a,b)},a.prototype.unfocus.live=!0,a.prototype.clearFocus=function(a,b){this.view&&this.view.clearFocus(a,b)},a.prototype.clearFocus.live=!0,a.prototype.display=function(a,b){this.view&&this.view.display(a,b)},a.prototype.display.live=!0,a.prototype.allNodes=function(a,b){a&&(b(a),this.allNodes(a.left,b),this.allNodes(a.right,b))},a.prototype.copyTree=function(b,c){var d=null;return b&&(d=new a.Node(b.value,b.id,null,null),d.parent=c,d.left=this.copyTree(b.left,d),d.right=this.copyTree(b.right,d)),d},a.prototype.getNodeById=function(a){var b="object"==typeof a?a.id:a;return this.nodes[b]},a.prototype.setNodeById=function(a,b){this.nodes[b.id]=b},a.prototype.computeHeights=function(a){return a?a.height=1+Math.max(this.computeHeights(a.left),this.computeHeights(a.right)):-1},a.prototype.setNodeIds=function(a,b){a&&("undefined"==typeof a.id&&(a.id=this.getNextNodeId(b)),console.info("Setting node id."),this.nodes[a.id]=a,this.setNodeIds(a.left,b),this.setNodeIds(a.right,b))},a.prototype.getNextNodeId=function(a){return a.nextId++},a}(),S.TreeView=function(){function a(a,b){S.View.call(this,a,b),this.elementMap={},this.positionMap={},this.futurePositionMap={},this.labelMap={},this.lastState={},this.options={classes:{svg:"tree-svg",node:"tree-node",value:"tree-value",height:"tree-height",label:"tree-label",line:"tree-line",hidden:"tree-hidden",nodeFocus:"tree-node--focused"},easings:{remove:mina.easeinout},autoScale:!0,autoScaleOptions:{proportionalTo:"height",scaleX:.1,scaleY:.15,nodeRadius:.05},offsetX:0,offsetY:0,scaleX:75,scaleY:50,nodeRadius:32},this.state&&this.render()}return a.prototype=Object.create(S.View.prototype),a.prototype.constructor=a,a.prototype.autoScale=function(a,b){var c="height"==this.options.autoScaleOptions.proportionalTo?b:a;this.options.nodeRadius=this.options.autoScaleOptions.nodeRadius*c,this.options.offsetX=a/2,this.options.offsetY=this.options.nodeRadius,this.options.scaleY=c*this.options.autoScaleOptions.scaleY,this.options.scaleX=c*this.options.autoScaleOptions.scaleX},a.prototype.render=function(){var a=this;this.clear(),this._svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg=Snap(this._svg),this.svg.addClass(this.options.classes.svg),this.svg.attr({width:this.$element.width(),height:this.$element.height()}),this.positionNodes(),this._drawLines(this.state.root),this.allNodes(this.state.root,function(b){var c=a.positionMap[b.id].x,d=a.positionMap[b.id].y;a.elementMap[b.id].node=a.drawNode(b,c,d),a.elementMap[b.id].value=a.drawValue(b.value,c,d),a.elementMap[b.id].height=a.drawHeight(b.height,c,d)}),this.$element.append(this._svg)},a.prototype.positionNodes=function(){var b,c=this;a.rg(this.state.root),this.allNodes(this.state.root,function(a){c.positionMap[a.id]||(c.positionMap[a.id]={}),b=c.transformNodeCoordinates(a.x,a.y),c.positionMap[a.id].x=b.x,c.positionMap[a.id].y=b.y,c.positionMap[a.id].nodeSpaceX=a.x,c.positionMap[a.id].nodeSpaceY=a.y,delete a.x,delete a.y})},a.prototype.transformNodeCoordinates=function(a,b){return{x:this.options.offsetX+a*this.options.scaleX,y:this.options.offsetY+b*this.options.scaleY}},a.prototype.onResize=function(){this.options.autoScale&&this.autoScale(this.$element.width(),this.$element.height()),this.render()},a.prototype.drawGridDots=function(){},a.prototype._drawLines=function(a){var b=this.positionMap[a.id].x,c=this.positionMap[a.id].y;this.elementMap[a.id]||(this.elementMap[a.id]={}),a.left&&(this.elementMap[a.id].leftLine=this.drawLine(b,c,this.positionMap[a.left.id].x,this.positionMap[a.left.id].y),this._drawLines(a.left)),a.right&&(this.elementMap[a.id].rightLine=this.drawLine(b,c,this.positionMap[a.right.id].x,this.positionMap[a.right.id].y),this._drawLines(a.right))},a.prototype.allNodes=function(a,b){a&&(b(a),this.allNodes(a.left,b),this.allNodes(a.right,b))},a.prototype.getValuePosition=function(a,b){return{x:a,y:.5*this.options.nodeRadius+b}},a.prototype.getHeightPosition=function(a,b){return{x:a-this.options.nodeRadius-.85*this.options.nodeRadius,y:b+.5*this.options.nodeRadius-3}},a.prototype.drawLine=function(a,b,c,d,e){var f=this.svg.line(a,b,c,d).addClass(this.options.classes.line);return e&&f.insertBefore(e),f},a.prototype.drawNode=function(a,b,c){return this.svg.circle(b,c,this.options.nodeRadius).addClass(this.options.classes.node)},a.prototype.drawNodeShadow=function(a,b,c,d){return this.svg.circle(a+c,b+d,this.options.nodeRadius).attr("fill","#000000")},a.prototype.drawValue=function(a,b,c){var d=this.getValuePosition(b,c);return this.svg.text(d.x,d.y,a+"").addClass(this.options.classes.value).attr("text-anchor","middle").attr("font-size",1.25*this.options.nodeRadius)},a.prototype.drawHeight=function(a,b,c){var d=this.getHeightPosition(b,c);return this.svg.text(d.x,d.y,a+"").attr("font-size",this.options.nodeRadius).addClass(this.options.classes.height)},a.prototype.drawLabel=function(){},a.prototype.calculateFuturePositions=function(b){console.info("Calculating future positions.");var c=this;a.rg(b),this.allNodes(b,function(a){c.futurePositionMap[a.id]=c.transformNodeCoordinates(a.x,a.y)}),console.log("Future positions:"),console.dir(this.futurePositionMap)},a.prototype.updateHeights=function(a){var b=this;this.allNodes(a,function(a){b.elementMap[a.id]&&b.elementMap[a.id].height.attr("text",a.height+"")})},a.prototype.add=function(a,b,c,d){var e,f=this,g=b?a.right:a.left,h=this.positionMap[a.id].x,i=this.positionMap[a.id].y,j=this.positionMap[a.id].y+this.options.scaleY;this.updateHeights(this.state.root),e=b?this.positionMap[a.id].x+this.options.scaleX:this.positionMap[a.id].x-this.options.scaleX,this.elementMap[g.id]={node:this.drawNode(g,e,j),value:this.drawValue(g.value,e,j),height:this.drawHeight(g.height,e,j)},b?this.elementMap[a.id].rightLine=this.drawLine(h,i,e,j,this.elementMap[a.id].node):this.elementMap[a.id].leftLine=this.drawLine(h,i,e,j,this.elementMap[a.id].node),this.positionNodes(),this.allNodes(this.state.root,function(a){var b=f.positionMap[a.id],c=f.getValuePosition(f.positionMap[a.id].x,f.positionMap[a.id].y),d=f.getHeightPosition(f.positionMap[a.id].x,f.positionMap[a.id].y),e=f.elementMap[a.id];if(e.value.animate({x:c.x,y:d.y},250,mina.easein,function(){}),e.height.animate({x:d.x,y:d.y},250,mina.easein,function(){}),e.rightLine){var g=f.positionMap[a.right.id];e.rightLine.animate({x1:b.x,y1:b.y,x2:g.x,y2:g.y},250,mina.easein,function(){})}if(e.leftLine){var h=f.positionMap[a.left.id];e.leftLine.animate({x1:b.x,y1:b.y,x2:h.x,y2:h.y},250,mina.easein,function(){})}e.node.animate({cx:b.x,cy:b.y},250,mina.easein,function(){})}),d()},a.prototype.tweenToPositions=function(){this.allNodes(this.state.root,function(a){var b=self.positionMap[a.id],c=self.getValuePosition(b.x,b.y),d=self.getHeightPosition(b.x,b.y),e=self.elementMap[a.id];if(e.value.animate({x:c.x,y:d.y},250,mina.easein,function(){}),e.height.animate({x:d.x,y:d.y},250,mina.easein,function(){}),e.rightLine){var f=self.positionMap[a.right.id];e.rightLine.animate({x1:b.x,y1:b.y,x2:f.x,y2:f.y},250,mina.easein,function(){})}if(e.leftLine){var g=self.positionMap[a.left.id];e.leftLine.animate({x1:b.x,y1:b.y,x2:g.x,y2:g.y},250,mina.easein,function(){})}e.node.animate({cx:b.x,cy:b.y},250,mina.easein,function(){})})},a.prototype.set=function(a,b,c){var d=this.view._,e=d.data(a).element,f=d.data(a).s_value;S.wait(function(){e.addClass("tree-remove"),f.addClass("tree-remove"),S.wait(function(){e.removeClass("tree-remove"),f.removeClass("tree-remove").attr("text",b),c()},300)},200)},a.prototype.remove=function(){},a.prototype.focus=function(a,b){console.log("Focusing"),a&&this.elementMap[a.id].node.addClass("focus"),b()},a.prototype.unfocus=function(a,b){a&&this.elementMap[a.id].node.removeClass("focus"),b()},a.prototype.clearFocus=function(){},a.prototype.animateTravel=function(a,b){console.log("Animating travel!"),a.addClass("tree-line-active");var c=this.spawnTravelOrb(a);c.animate({cx:a.attr("x2"),cy:a.attr("y2")},500,null,function(){c.remove(),a.removeClass("tree-line-active"),b()})},a.prototype.spawnTravelOrb=function(a){return this.svg.circle(a.attr("x1"),a.attr("y1"),5).addClass("tree-travelorb").insertAfter(a)},a.prototype.travel=function(a,b,c){console.log("travel: parent.id is %s",a.id),console.dir(a),console.dir(this.elementMap[a.id]),b&&this.elementMap[a.id].rightLine?this.animateTravel(this.elementMap[a.id].rightLine,c):!b&&this.elementMap[a.id].leftLine?this.animateTravel(this.elementMap[a.id].leftLine,c):(console.log("Cannnot travel."),c())},a.prototype.label=function(a,b,c){c()},a.prototype.clearLabels=function(){},a.prototype.display=function(){},a.rg=function(b){a.rg.position(b,0,{lmost:{},rmost:{}},{minimumSeparation:1}),a.rg.absolute(b,0),a.rg.cleanup(b)},a.rg.position=function(b,c,d,e){var f,g,h,i,j,k,l={lmost:{},rmost:{}},m={lmost:{},rmost:{}};if(!b)return d.lmost.level=-1,void(d.rmost.level=-1);if(b.y=c,f=b.left,g=b.right,a.rg.position(f,c+1,l,e),a.rg.position(g,c+1,m,e),!b.left&&!b.right)return d.rmost.node=b,d.lmost.node=b,d.rmost.level=c,d.lmost.level=c,d.rmost.offset=0,d.lmost.offset=0,void(b.offset=0);for(j=e.minimumSeparation,k=e.minimumSeparation;f&&g;)j<e.minimumSeparation&&(k+=e.minimumSeparation-j,j=e.minimumSeparation),f.right?(h+=f.offset,j-=f.offset,f=f.right):(h-=f.offset,j+=f.offset,f=f.left),g.left?(i-=g.offset,j-=g.offset,g=g.left):(i+=g.offset,j+=g.offset,g=g.right);b.offset=(k+1)/2,h-=b.offset,i+=b.offset,!b.left||m.lmost.level>l.lmost.level?(d.lmost=m.lmost,d.lmost.offset+=b.offset):(d.lmost=l.lmost,d.lmost.offset-=b.offset),!b.right||l.rmost.level>m.rmost.level?(d.rmost=l.rmost,d.rmost.offset-=b.offset):(d.rmost=m.rmost,d.rmost.offset+=b.offset),f&&f!==b.left?(m.rmost.node.thread=!0,m.rmost.node.offset=Math.abs(m.rmost.offset+b.offset-h),h-b.offset<=m.rmost.offset?m.rmost.node.left=f:m.rmost.node.right=f):g&&g!==b.right&&(l.lmost.node.thread=!0,l.lmost.node.offset=Math.abs(l.lmost.offset-b.offset-i),i+b.offset>=l.lmost.offset?l.lmost.node.right=g:l.lmost.node.left=g)},a.rg.absolute=function(b,c){b&&(b.x=c,b.thread&&(b.thread=!1,b.left=null,b.right=null),a.rg.absolute(b.left,c-b.offset),a.rg.absolute(b.right,c+b.offset))},a.rg.cleanup=function(b){b&&(delete b.offset,delete b.thread,a.rg.cleanup(b.left),a.rg.cleanup(b.right))},a}(),S.Heap=function(){function a(a,b){this.alias="heap",this.nodesByIndex=[];var c={root:this.makeTree(a.array,null,0),lastId:a.lastId||0};console.log("Heap()"),this.tree=new S.Tree(c,b?b.treeView:null),this.array=new S.Array(a,b?b.arrayView:null),S.Component.call(this,a,b)}return a.prototype=Object.create(S.Component.prototype),a.prototype.constructor=a,a.prototype.push=function(a,b){var c=!1,d=this;this.array.push(a,function(){c?b():c=!0});var e=this.array.state.array.length-1;console.log("Parent of %s is %s",a,this.array.state.array[this.getParentIndex(e)]),this.tree.add(this.getNodeByIndex(this.getParentIndex(e)),this.getAvailableDirection(e),a,function(a){d.nodesByIndex[e]=a,c?b():c=!0})},a.prototype.push.live=!0,a.prototype.makeTree=function(a,b,c){if(c>a.length-1)return null;var d=new S.Tree.Node(a[c],c,null,null);return d.left=this.makeTree(a,d,2*(c+1)-1),d.right=this.makeTree(a,d,2*(c+1)),d.parent=b,this.nodesByIndex[c]=d,d},a.prototype.getParentIndex=function(a){return Math.floor((a+1)/2)-1},a.prototype.getAvailableDirection=function(a){return a%2==0?!0:!1},a.prototype.getNodeByIndex=function(a){return this.nodesByIndex[a]},a.prototype.getLength=function(a){return this.array.view?void this.array.getLength(a):this.array.getLength()},a.prototype.getLength.live=!0,a.prototype.focus=function(a,b){var c=!1;this.tree.focus(this.getNodeByIndex(a),function(){c?b():c=!0}),this.array.focus(a,function(){c?b():c=!0})},a.prototype.focus.live=!0,a}(),S.HeapView=function(){function a(a,b){S.View.call(this,a,b),this.$element.append($('<div class="heap-tree" style="height: 75%;"></div>')),this.$element.append($('<div class="heap-array" style="height: 25%;"></div>')),this.treeElement=this.$element.find(".heap-tree"),this.arrayElement=this.$element.find(".heap-array"),this.treeView=new S.TreeView(null,this.treeElement),this.arrayView=new S.ArrayView(null,this.arrayElement),this.treeView.options.autoScaleOptions.scaleY=.2}return a.prototype=Object.create(S.View.prototype),a.prototype.constructor=a,a.prototype.init=function(){},a.prototype.onResize=function(){this.treeView.onResize(),this.arrayView.render()},a}(),S.method(function(a){for(var b=0;b<a.getLength();b++){for(this("j",b);this("j")>0&&a.getItem(this("j")-1)>a.getItem(this("j"));)this("temp",a.getItem(this("j"))),a.setItem(this("j"),a.getItem(this("j")-1)),a.setItem(this("j")-1,this("temp")),this("swapped",!0),this("j",this("j")-1);a.range(0,b,1)}a.clearrange(1)},"insertionSort","array"),S.method(function(a,b){function c(b){b&&(f.call(this,b),a.travel(b,!1),c.call(this,b.left),a.travel(b,!0),c.call(this,b.right))}function d(b){b&&(a.travel(b,!1),d.call(this,b.left),f.call(this,b),a.travel(b,!0),d.call(this,b.right))}function e(b){b&&(a.travel(b,!1),e.call(this,b.left),a.travel(b,!0),e.call(this,b.right),f.call(this,b))}function f(b){a.focus(b),g.call(this,b)}function g(b){a.label(b,h),h++}var h=0;b&&(b=b.trim().toLowerCase()),"pre"===b||"preorder"===b?c.call(this,a.root()):"in"===b||"inorder"===b?d.call(this,a.root()):"post"===b||"postorder"===b?e.call(this,a.root()):d.call(this,a.root())},"traversal","tree");