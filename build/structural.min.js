window.S=function(){"use strict";var a={};return a.definitions={},a.define=function(b,c){console.info("Defining %s",c);var d=c.split("."),e=a.definitions;d.forEach(function(a){e[a]||((e[a]={}).value=null),e=e[a]}),e.value=b},a.get=function(b){if(!(b.indexOf("undefined")>-1)){var c=b.split("."),d=a.definitions;return c.forEach(function(a){d[a]||((d[a]={}).value=null),d=d[a]}),d.value}},a.component=function(b,c){return c?void a.defineComponent(b,c):a.instantiateComponent(b)},a.defineComponent=function(b,c){a.define(c,"components."+b)},a.instantiateComponent=function(b){return new a.get("components."+b)},a.method=function(b,c,d){var e="components."+d+".methods";a.get(e)||a.define([],e),a.get(e).push({name:c,func:b})},a.components=function(b){"function"==typeof a.get("components."+b)},a.EventEmitter=function(){this.registeredEvents={}},a.EventEmitter.prototype.on=function(a,b){this.registeredEvents[a]||(this.registeredEvents[a]=[]),this.registeredEvents[a].push(b)},a.EventEmitter.prototype.fire=function(a,b){if(this.registeredEvents[a])for(var c=0;c<this.registeredEvents[a].length;c++)this.registeredEvents[a][c].call(b,b)},a.extend=function(){var a=Array.prototype.slice.call(arguments),b={};return a.forEach(function(a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])}),b},a.map=function(){var a={},b={},c=function(c,d){if(!c.id)throw new Error("S.map() requires id property");return"undefined"==typeof d?(a[c.id]||(a[c.id]={}),a[c.id]):(a[c.id]=d,void(b[c.id]=c))};return c.clear=function(){a={},b={}},c.delete=function(b){if(!b.id)throw new Error("S.map() requires id property");delete a[b.id]},c.has=function(b){if(!b.id)throw new Error("S.map() requires id property");return"undefined"!=typeof a[b.id]},c.forEach=function(c,d){d||(d={});for(var e in a)c.call(d,[b[e],a[e]])},c},a.wait=function(a,b){setTimeout(a,b)},a}(),S.config={provideDefaultDeferredContext:!0,viewClass:"structural_view"},S.Component=function(a,b){console.info("Component constructor"),a&&(this.state=a),b&&(this.view=b)},S.Component.prototype=Object.create(S.EventEmitter.prototype),Object.defineProperty(S.Component.prototype,"state",{get:function(){var a;return this.onGetState&&(a=this.onGetState(this._state)||this._state),a},set:function(a){var b;this.onSetState&&(b=this.onSetState(a)||a),this._state=b}}),Object.defineProperty(S.Component.prototype,"view",{get:function(){return this._view},set:function(a){this._view=a,a.component=this,a.init()}}),S.Component.prototype.makeViewOnly=function(){for(var a in this.live)this.live.hasOwnProperty(a)&&null===a&&(this.live[a]=function(a){}(a))},S.Component.prototype.bindLive=function(){for(var a in this.live)this.live.hasOwnProperty(a)&&"function"==typeof this.live[a]&&this.live[a].bind(this)},S.Component.prototype.init=function(){},S.View=function(a){this.$element=a instanceof jQuery?a:jQuery(a),this.interactive=!0},S.View.prototype=Object.create(S.EventEmitter.prototype),S.View.prototype.clear=function(){this.$element.empty()},S.View.prototype.enableInteractivity=function(){this.interactive=!0},S.View.prototype.disableInteractivity=function(){this.interactive=!1},S.AsyncFunctionQueue=function(){function a(){this.functionList=[],this.position=0,this.sleep=10,this.states=[],this._open=!1,this.clearOnFinish=!0,this.executing=!1}return a.prototype.push=function(a){this.functionList.push(a),this._open&&!this.executing&&this.exec()},a.prototype.clear=function(){this.executing=!1,this.functionList=[],this.position=0},a.prototype.next=function(a){var b=this;this.functionList[this.position].call(b,function(){b.position++,a()})},a.prototype.exec=function(){function a(){return b.position>=b.functionList.length&&b.clearOnFinish&&b.clear(),b.position>=b.functionList.length||!b.executing||!b.functionList[b.position]?(b.executing=!1,void console.groupEnd()):void b.next(function(){setTimeout(a,b.sleep)})}console.groupCollapsed("AsyncFunctionQueue executing"),this.executing=!0;var b=this;a()},a.prototype.pause=function(){this.executing=!1},a.prototype.open=function(){this._open=!0,this.exec()},a.prototype.close=function(){this._open=!1,this.executing=!1},Object.defineProperty(a.prototype,"length",{get:function(){return this.functionList.length}}),Object.defineProperty(a.prototype,"completion",{get:function(){return this.position/this.functionList.length}}),a}(),S.Deferred=function(){function a(a){var c=this;S.EventEmitter.call(this),this.queue=a,this.handle={},this.handle.standard=function(a,b){return"undefined"==typeof b?c.handle.standard._get(a):void c.handle.standard._set(a,b)},this.include(b(),b(),{name:"standard"})}function b(){var a={},b={};return a.flog=function(a,b){console.log(a),b&&b()},a.flog.live=!0,a.fwarn=function(a,b){console.warn(a),b&&b()},a.fwarn.live=!0,a._set=function(a,c,d){b[a]=c,d&&d()},a._set.live=!0,a._get=function(a,c){return c&&c(),b[a]},a._get.live=!0,a.comment=function(){},a.comment.live=!0,a}var c={};return a.prototype=Object.create(S.EventEmitter.prototype),a.prototype.include=function(a,b,d){var d=S.extend(c,d),e=this.handle[d.name||a]?this.handle[d.name||a]:this.handle[d.name||a]={},f=this,g=S.get("components."+a.alias+".methods");for(var h in a)"function"==typeof a[h]&&a[h].live&&(e[h]=function(c){var d=function(){var d=Array.prototype.slice.call(arguments);return f.queue.push(function(b){a[c].apply(a,d.concat(b))}),b[c].apply(b,d)};return d}(h));g&&0!=g.length&&g.forEach(function(a){e[a.name]||(e[a.name]=function(){a.func.call(f.standard,e)})})},a}(),S.Array=function(){function a(a,b){this.alias="array",S.Component.call(this,a,b),this.state.flags=[]}return a.prototype=Object.create(S.Component.prototype),a.prototype.constructor=a,a.prototype.onSetState=function(a){return[].concat(a)},a.prototype.onGetState=function(a){return a},a.prototype.getLength=function(a){return this.view?void a(this.state.length):this.state.length},a.prototype.getLength.live=!0,a.prototype.flag=function(a,b){this.state.flags[a]=!0,this.view&&this.view.flag(a,b)},a.prototype.flag.live=!0,a.prototype.flagged=function(a,b){return this.view?void b(this.state.length):this.state.flags[a]},a.prototype.flagged.true,a.prototype.setItem=function(a,b,c){this.state[a]=b,this.view&&this.view.setItem(a,b,c)},a.prototype.setItem.live=!0,a.prototype.getItem=function(a,b){return this.view?void b(this.state[a]):this.state[a]},a.prototype.getItem.live=!0,a.prototype.push=function(a,b){this.state.push(a),this.view&&this.view.push(a,b)},a.prototype.push.live=!0,a.prototype.focus=function(a,b){this.view&&this.view.focus(a,b)},a.prototype.focus.live=!0,a.prototype.range=function(a,b,c,d){this.view&&this.view.range(a,b,c,d)},a.prototype.range.live=!0,a.prototype.clearfocus=function(a){this.view&&this.view.clearfocus(a)},a.prototype.clearfocus.live=!0,a.prototype.clearrange=function(a,b){this.view&&this.view.clearrange(a,b)},a.prototype.clearrange.live=!0,a.prototype.leftTo=function(a,b){this.view&&this.view.leftTo(a,b)},a.prototype.leftTo.live=!0,a}(),S.ArrayView=function(){function a(a){S.View.call(this,a),this.options={hiddenDelimiter:",",numElements:5,pageTime:300,stepTime:50,scrollTime:500,maxScrollTime:1e3},this.leftBound=0,this.rightBound=this.options.numElements-1,this.$e=null,this.$table=null,this.$topRow=null,this.$bottomRow=null,this.$cells=$(),this.$indices=$(),this.computedWidth=null,this.width=null,this.border=0,this.computedCellWidth=null,this.height=null}return a.prototype=Object.create(S.View.prototype),a.prototype.constructor=a,a.prototype.init=function(){this.$e=$('<div class="array"></div>'),this.scaleTo({width:this.$element.width(),height:this.$element.height()})},a.prototype.scaleTo=function(a){this.width=a.width,this.height=a.height,this.$e.css("width",a.width),this.$e.css("height",a.height),this.computedCellWidth=Math.floor(this.width/this.options.numElements)-this.border,this.render()},a.prototype.render=function(){this.clear(),this.$cells=$(),this.$indices=$(),this.$table=$("<table></table>").addClass("array-table"),this.$topRow=$("<tr></tr>").addClass("array-top"),this.$bottomRow=$("<tr></tr>").addClass("array-bottom"),this.$e.append(this.$table),this.$table.append(this.$topRow).append(this.$bottomRow),this.$table.css({height:this.height}),this.$topRow.css({fontSize:Math.round(.25*this.$table.height())});for(var a=0;a<this.component.state.length;a++){var b=$("<td>"+this.component.state[a]+'<span style="font-size: 0;">'+this.options.hiddenDelimiter+"</span></td>"),c=$("<th>"+a+"</th>");b.data("index",a),c.data("index",a),b.width(this.computedCellWidth),c.width(this.computedCellWidth),b.addClass("array-cell"),c.addClass("array-index"),this.$topRow.append(b),this.$bottomRow.append(c),this.$cells=this.$cells.add(b),this.$indices=this.$indices.add(c)}this.computedWidth=this.computedCellWidth+this.border,this.width=this.options.numElements*this.computedWidth+this.border,this.$e.css("width",this.width),this.$element.append(this.$e),this.bindEvents(this.$cells,this.$indices)},a.prototype.bindEvents=function(){var a=this;this.$cells.click(function(){a.interactive&&(console.log("handleTdClick"),a.focus($(this).data("index")))}),this.$cells.dblclick(function(){a.interactive&&($(this).hasClass("array-flagged")?$(this).removeClass("array-flagged"):$(this).addClass("array-flagged"))})},a.prototype.focus=function(a,b){if(!(0>a||a>this.component.state.length-1)){this.$cells.removeClass("focus"),this.$indices.removeClass("focus"),this.$cells.eq(a).addClass("focus"),this.$indices.eq(a).addClass("focus");var c=a-Math.floor(this.options.numElements/2);this.leftTo(c,b)}},a.prototype.focus.live=!0,a.prototype.clearfocus=function(a){this.$cells.removeClass("focus"),this.$indices.removeClass("focus"),a()},a.prototype.clearfocus.live=!0,a.prototype.flag=function(a,b){this.$cells.eq(a).addClass("array-flagged"),b&&b()},a.prototype.flag.live=!0,a.prototype.range=function(a,b,c,d){var e=this.$cells.slice(a,b+1),f="range"+c;e.addClass(function(a){var b=e.eq(a).attr("class"),c=f+" "+b;e.eq(a).attr("class",c)}),d()},a.prototype.range.live=!0,a.prototype.clearrange=function(a,b){this.$cells.removeClass("range"+a),b()},a.prototype.clearrange.live=!0,a.prototype.setItem=function(a,b,c){var d=this;this.focus(a,function(){S.wait(function(){d.$cells.eq(a).addClass("array-remove"),S.wait(function(){d.$cells.eq(a).text(b),d.$cells.eq(a).removeClass("array-remove"),c()},300)},200)})},a.prototype.setItem.live=!0,a.prototype.push=function(a,b){var c=this.addItem(a,this.component.state.length-1);this.leftTo(this.component.state.length-1,function(){c.animate({opacity:1},200,function(){b()})})},a.prototype.push.live=!0,a.prototype.addItem=function(a,b){var c=$("<td>"+a+"</td>"),d=$("<th>"+b+"</th>"),e=c.add(d).css({opacity:0,width:this.computedCellWidth});return c.addClass("array-cell"),d.addClass("array-index"),e.data("index",b),this.$topRow.append(c),this.$bottomRow.append(d),this.$cells=this.$cells.add(c),this.$indices=this.$indices.add(d),this.bindEvents(c,d),e},a.prototype.leftTo=function(a,b){if(a=parseInt(a,10),!isNaN(a)){0>=a&&(a=0),a>=this.component.state.length-1&&(a=this.component.state.length-1);var c=Math.min(Math.abs(a-this.leftBound)*this.options.stepTime,this.options.maxScrollTime);0==a?(this.leftBound=0,this.rightBound=this.options.numElements-1):a>this.component.state.length-this.options.numElements?(this.leftBound=this.component.state.length-this.options.numElements,this.rightBound=this.component.state.length-1):(this.leftBound=a,this.rightBound=a+this.options.numElements-1),this.scrollTo(a*this.computedWidth,c,b)}},a.prototype.rightTo=function(a){if(a=parseInt(a,10),!isNan(a)){0>=a&&(a=0),a>=this.component.state.length-1&&(a=this.component.state.length-1);var b=Math.min(Math.abs(a-this.leftBound)*this.options.stepTime,this.options.maxScrollTime);a<=this.options.numElements-1?(this.leftBound=0,this.rightBound=this.options.numElements-1):a==this.component.state.length-1?(this.leftBound=this.component.state.length-this.options.numElements,this.rightBound=this.component.state.length-1):(this.leftBound=a-this.options.numElements+1,this.rightBound=a),scrollTo(a*this.computedWidth,b)}},a.prototype.pageRight=function(){this.leftBound=this.leftBound+this.options.numElements<=this.component.state.length-this.options.numElements?this.leftBound+this.options.numElements:this.component.state.length-this.options.numElements,this.rightBound=this.rightBound+this.options.numElements<=this.component.state.length-1?this.rightBound+this.options.numElements:this.component.state.length-1,page(!0)},a.prototype.pageLeft=function(){this.leftBound=this.leftBound-this.options.numElements>=0?this.leftBound-this.options.numElements:0,this.rightBound=this.rightBound-this.options.numElements>=this.options.numElements-1?this.rightBound-this.options.numElements:this.options.numElements-1,page(!1)},a.prototype.right=function(){this.leftBound=this.leftBound+1<=this.component.state.length-this.options.numElements?this.leftBound+1:this.component.state.length-this.options.numElements,this.rightBound=this.rightBound+1<=this.component.state.length-1?this.rightBound+1:this.component.state.length-1,this.step(!0)},a.prototype.left=function(){this.leftBound=this.leftBound-1>=0?this.leftBound-1:0,this.rightBound=this.rightBound-1>=this.options.numElements-1?this.rightBound-1:this.options.numElements-1,this.step(!1)},a.prototype.page=function(a){this.scroll(a,this.options.pageTime,this.width-1)},a.prototype.step=function(a){this.scroll(a,this.options.stepTime,this.computedWidth)},a.prototype.scroll=function(a,b,c){var d="+=";a||(d="-=");var e={};e.scrollLeft=d+c,this.$e.animate(e,b)},a.prototype.scrollTo=function(a,b,c){this.$e.animate({scrollLeft:a},b,function(){"undefined"!=typeof c&&c()})},a}(),S.Tree=function(){function a(a,b){this.alias="tree",this.nodes={},S.Component.call(this,a,b)}return a.prototype=Object.create(S.Component.prototype),a.prototype.constructor=a,a.Node=function(a,b,c,d){this.value=a,this.id=b,this.left=c,this.right=d},a.prototype.onSetState=function(a){this.lastId=a.lastId||0;var b=this.copy(a,null);return b.lastId=this.lastId,this.computeHeights(b),b},a.prototype.onGetState=function(a){return a},a.prototype.root=function(a){return this._view?void a(this.state):this.state},a.prototype.root.live=!0,a.prototype.add=function(b,c,d,e){b=this.getNodeById(b);var f;if(c){if(b.right)return;f=b.right=new a.Node(d,this.getNextNodeId(),null,null)}else{if(b.left)return;f=b.left=new a.Node(d,this.getNextNodeId(),null,null)}return this.setNodeById(f.id,f),this.computeHeights(this.state),this._view?void this._view.add(b,c,d,function(){e(f)}):f},a.prototype.add.live=!0,a.prototype.remove=function(a,b){a=this.getNodeById(a);a.parent;a.parent&&a.parent.left==a?a.parent.left=null:a.parent&&a.parent.right==a&&(a.parent.right=null),this.computeHeights(this.state),this._view&&this._view.remove(a,b)},a.prototype.remove.live=!0,a.prototype.set=function(a,b,c){return a=this.getNodeById(a),a.value=b,this._view?void this._view.set(a,b,function(){c(a)}):a},a.prototype.set.live=!0,a.prototype.get=function(a,b){return a=this.getNodeById(a),this._view?void b(a.value):a.value},a.prototype.get.live=!0,a.prototype.height=function(a){return this._view&&a(this.computeHeights(this._state)),this.computeHeights(this._state)},a.prototype.height.live=!0,a.prototype.mark=function(a){this._view&&this._view.mark(a)},a.prototype.mark.live=!0,a.prototype.markPath=function(a){this._view&&this._view.markPath(a)},a.prototype.markPath.live=!0,a.prototype.clearPath=function(a){this._view&&this._view.clearPath(a)},a.prototype.clearPath.live=!0,a.prototype.clearLabels=function(a){this._view&&this._view.clearLabels(a)},a.prototype.clearLabels.live=!0,a.prototype.travel=function(a,b,c){this._view&&this._view.travel(a,b,c)},a.prototype.travel.live=!0,a.prototype.label=function(a,b,c){this._view&&this._view.label(a,b,c)},a.prototype.label.live=!0,a.prototype.focus=function(a,b){this._view&&this._view.focus(a,b)},a.prototype.focus.live=!0,a.prototype.unfocus=function(a,b){this._view&&this._view.unfocus(a,b)},a.prototype.unfocus.live=!0,a.prototype.clearFocus=function(a,b){this._view&&this._view.clearFocus(a,b)},a.prototype.clearFocus.live=!0,a.prototype.display=function(a,b){this._view&&this._view.display(a,b)},a.prototype.display.live=!0,a.prototype.all=function(a,b){a&&(b(a),this.all(a.left,b),this.all(a.right,b))},a.prototype.copy=function(b,c){if(!b)return null;var d=new a.Node(b.value,b.id||this.getNextNodeId(),null,null);return d.parent=c,d.left=this.copy(b.left,d),d.right=this.copy(b.right,d),this.setNodeById(d.id,d),d},a.prototype.getNodeById=function(a){var b="string"==typeof a?a:a.id;return this.nodes[b]},a.prototype.setNodeById=function(a,b){this.nodes[b.id]=b},a.prototype.computeHeights=function(a){return a?a.height=1+Math.max(this.computeHeights(a.left),this.computeHeights(a.right)):-1},a.prototype.getNextNodeId=function(){this.lastId;return this.lastId++,this._state&&(this._state.lastId=this.lastId),this.lastId},a}(),S.TreeView=function(){function a(a){S.View.call(this,a),this._={},this._.data=S.map(),this.options={classes:{svg:"tree-svg",node:"tree-node",value:"tree-value",height:"tree-height",label:"tree-label",line:"tree-line",hidden:"tree-hidden",nodeFocus:"tree-node--focused"},easings:{remove:mina.easeinout}},this.view=this}function b(a,c){var d=[];return a?(d.push(c(a).element),d.push(c(a).s_height),d.push(c(a).s_value),d.push(c(a).s_label),d.push(c(a).leftLine),d.push(c(a).rightLine),d.concat(b(a.left,c).concat(b(a.right,c)))):d}return a.prototype=Object.create(S.View.prototype),a.prototype.constructor=a,a.prototype.init=function(){this.scale({width:this.$element.width(),height:this.$element.height()})},a.prototype.scale=function(a){var b=this._,c=.05,d=.2;return b.width=a.width,b.height=a.height,b.x0=b.width/2,b.nodeRadius=c*b.height,b.y0=b.nodeRadius,b.mv=d*b.height,b.mh=b.mv+b.nodeRadius/2,this.render()},a.prototype.render=function(){console.log("state is "),console.dir(this.component.state);var b=this,c=b._;this.clear(),c._svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),c.svg=Snap(c._svg),c.svg.addClass(this.options.classes.svg),this._.svg.attr({width:c.width,height:c.height}),a.rg(this.component.state),this._drawLines(this.component.state),this.allNodes(this.component.state,function(a){c.data(a).x=c.x0+a.x*c.mh/2,c.data(a).y=c.y0+a.y*c.mv,delete a.x,delete a.y,console.log("drawing node with value "+a.value),c.data(a).element=b._drawNode(a,c.data(a).x,c.data(a).y),c.data(a).s_value=b._drawValue(a.value,c.data(a).x,c.data(a).y),c.data(a).s_height=b._drawHeight(a.height,c.data(a).x,c.data(a).y)}),this.drawGridDots(),this.$element.append(c._svg)},a.prototype.drawGridDots=function(){for(var a=-2*this._.mh;a<this._.svg.attr("width");a+=.5*this._.mh)for(var b=0;b<this._.svg.attr("height");b+=this._.mv)this._.svg.circle(this._.x0+a,this._.y0+b,2).attr("fill","#000000")},a.prototype._drawLines=function(a){var b=this._;a.left&&(b.data(a).leftLine=this._drawLine(b.data(a).x,b.data(a).y,b.data(a.left).x,b.data(a.left).y),this._drawLines(a.left)),a.right&&(b.data(a).rightLine=this._drawLine(b.data(a).x,b.data(a).y,b.data(a.right).x,b.data(a.right).y),this._drawLines(a.right))},a.prototype._drawLine=function(a,b,c,d){return this._.svg.line(a,b,c,d).addClass(this.options.classes.line)},a.prototype.allNodes=function(a,b){a&&(b(a),this.allNodes(a.left,b),this.allNodes(a.right,b))},a.prototype._drawNode=function(a,b,c){return this._.svg.circle(b,c+2,this._.nodeRadius).addClass(this.options.classes.node)},a.prototype._drawValue=function(a,b,c){var d=this._;return d.svg.text(b,c+.5*d.nodeRadius+2,a+"").addClass(this.options.classes.value).attr("text-anchor","middle").attr("font-size",1.25*d.nodeRadius)},a.prototype._drawHeight=function(a,b,c){var d=this._;return d.svg.text(b-d.nodeRadius-.85*d.nodeRadius,c+d.nodeRadius/2-3,a+"").attr("font-size",d.nodeRadius).addClass(this.options.classes.height)},a.prototype._drawLabel=function(a,b){var c=this._;return c.svg.text(c.data(a).x+c.nodeRadius+5,c.data(a).y+c.nodeRadius/2-3,"/"+b).addClass(this.options.classes.label).attr("text-anchor","right").attr("font-size",c.nodeRadius)},a.prototype.add=function(a,b,c,d){var a=this.component.getNodeById(a.id),e=this.view._;this.scale({width:e.width,height:e.height}),this.render(),d()},a.prototype.set=function(a,b,c){var d=this.view._,e=d.data(a).element,f=d.data(a).s_value;S.wait(function(){e.addClass("tree-remove"),f.addClass("tree-remove"),S.wait(function(){e.removeClass("tree-remove"),f.removeClass("tree-remove").attr("text",b),c()},300)},200)},a.prototype.remove=function(a,c){function d(){j>=e&&(h.forEach(function(a){a&&a.remove()}),f.render(),c())}var e,f=this.view,g=f._,h=b(a,g.data),i=a.parent,j=0;i&&null==i.left&&g.data(i).leftLine?(h.push(g.data(i).leftLine),delete g.data(i).leftLine):i&&null==i.right&&g.data(i).rightLine&&(h.push(g.data(i).rightLine),delete g.data(i).rightLine),e=h.length,h.forEach(function(a){j++,a&&(a.attr("cy")?a.animate({cy:1e3},500,f.options.easings.remove,d):a.attr("y1")?a.animate({y1:1e3,y2:1e3},500,f.options.easings.remove,d):a.animate({y:1e3},500,f.options.easings.remove,d))})},a.prototype.focus=function(a,b){a=this.view.component.getNodeById(a.id),a&&this.view._.data(a).element.addClass("focus"),b()},a.prototype.unfocus=function(a,b){a=this.view.component.getNodeById(a.id),a&&this.view._.data(a).element.removeClass("focus"),b()},a.prototype.clearFocus=function(){var a=this.view,b=a._;a.allNodes(a.component.state,function(a){b.data(a).element.removeClass("focus")})},a.prototype.travel=function(a,b,c){var d=this.view._;if(b)if(d.data(a).rightLine){var e=d.data(a).rightLine;e.addClass("tree-line-active");var f=d.svg.circle(e.attr("x1"),e.attr("y1"),5).addClass("tree-travelorb");f.insertAfter(e),f.animate({cx:e.attr("x2"),cy:e.attr("y2")},500,null,function(){f.remove(),e.removeClass("tree-line-active"),c()})}else c();else if(d.data(a).leftLine){var g=d.data(a).leftLine;g.addClass("tree-line-active");var f=d.svg.circle(g.attr("x1"),g.attr("y1"),5).addClass("tree-travelorb");f.insertAfter(g),f.animate({cx:g.attr("x2"),cy:g.attr("y2")},500,null,function(){f.remove(),g.removeClass("tree-line-active"),c()})}else c()},a.prototype.label=function(a,b,c){console.log("trying to label "+a.value);var d=this.view._;a&&d.data(a)?(d.data(a).label=b,d.data(a).s_label=this.view._drawLabel(a,b),c()):c()},a.prototype.clearLabels=function(){var a=this.view,b=a._;a.allNodes(a.component.state,function(a){b.data(a).s_label.remove()})},a.prototype.display=function(a){console.info("display");var b=this.view,c=b._;b.allNodes(b.component.state,function(d){var e=c.data(d);a.heights&&e.s_height.removeClass(b.options.classes.hidden),a.heights===!1&&e.s_height.addClass(b.options.classes.hidden),a.labels&&e.s_label.removeClass(b.options.classes.hidden),a.labels===!1&&e.s_label.addClass(b.options.classes.hidden),a.values&&e.s_value.removeClass(b.options.classes.hidden),a.values===!1&&e.s_value.addClass(b.options.classes.hidden),a.lines&&(e.leftLine.removeClass(b.options.classes.hidden),e.rightLine.removeClass(b.options.classes.hidden)),a.lines===!1&&(e.leftLine.addClass(b.options.classes.hidden),e.rightLine.addClass(b.options.classes.hidden)),a.nodes&&e.element.removeClass(b.options.classes.hidden),a.nodes===!1&&e.element.addClass(b.options.classes.hidden)})},a.prototype.transformNodeCoordinates=function(){},a.rg=function(b){a.rg.position(b,0,{lmost:{},rmost:{}},{minimumSeparation:1}),a.rg.absolute(b,0),a.rg.cleanup(b)},a.rg.position=function(b,c,d,e){var f,g,h,i,j,k,l={lmost:{},rmost:{}},m={lmost:{},rmost:{}};if(!b)return d.lmost.level=-1,void(d.rmost.level=-1);if(b.y=c,f=b.left,g=b.right,a.rg.position(f,c+1,l,e),a.rg.position(g,c+1,m,e),!b.left&&!b.right)return d.rmost.node=b,d.lmost.node=b,d.rmost.level=c,d.lmost.level=c,d.rmost.offset=0,d.lmost.offset=0,void(b.offset=0);for(j=e.minimumSeparation,k=e.minimumSeparation;f&&g;)j<e.minimumSeparation&&(k+=e.minimumSeparation-j,j=e.minimumSeparation),f.right?(h+=f.offset,j-=f.offset,f=f.right):(h-=f.offset,j+=f.offset,f=f.left),g.left?(i-=g.offset,j-=g.offset,g=g.left):(i+=g.offset,j+=g.offset,g=g.right);b.offset=(k+1)/2,h-=b.offset,i+=b.offset,!b.left||m.lmost.level>l.lmost.level?(d.lmost=m.lmost,d.lmost.offset+=b.offset):(d.lmost=l.lmost,d.lmost.offset-=b.offset),!b.right||l.rmost.level>m.rmost.level?(d.rmost=l.rmost,d.rmost.offset-=b.offset):(d.rmost=m.rmost,d.rmost.offset+=b.offset),f&&f!==b.left?(m.rmost.node.thread=!0,m.rmost.node.offset=Math.abs(m.rmost.offset+b.offset-h),h-b.offset<=m.rmost.offset?m.rmost.node.left=f:m.rmost.node.right=f):g&&g!==b.right&&(l.lmost.node.thread=!0,l.lmost.node.offset=Math.abs(l.lmost.offset-b.offset-i),i+b.offset>=l.lmost.offset?l.lmost.node.right=g:l.lmost.node.left=g)},a.rg.absolute=function(b,c){b&&(b.x=c,b.thread&&(b.thread=!1,b.left=null,b.right=null),a.rg.absolute(b.left,c-b.offset),a.rg.absolute(b.right,c+b.offset))},a.rg.cleanup=function(b){b&&(delete b.offset,delete b.thread,a.rg.cleanup(b.left),a.rg.cleanup(b.right))},a}();