<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script type="text/javascript" src="../lib/jquery-1.11.1.min.js"></script>
    <!--<script type="text/javascript" src="js/0core.js"></script>
    <script src="js/1eventemitter.js" type="text/javascript"></script>
    <script src="js/2base.js" type="text/javascript"></script>
    <script src="js/3view.js" type="text/javascript"></script>
    <script src="js/4livewrap.js" type="text/javascript"></script>
    <script src="js/5testarray.js" type="text/javascript"></script> -->
    <script src="../build/structural.js" type="text/javascript"></script>
    <link rel="stylesheet" href="../src/css/array.css"/>
    <script type="text/javascript">
        $(document).ready(function(){
            S.finalize();
            
            
            console.log();
            var myView = S.views.array.simple({
                numElements: 16
            });
            var array = [];
            for(var i = 0; i < 25; i++) {
                array[i] = Math.floor(Math.random() * 50);
            }
            var myArray = S.components.array(array, myView);
            myView.scaleTo({
                width: $(document).width()
            });
            $('body').append(myView.render());

            myView.focus();
            
            
            
            var deferred = S.deferred();
            deferred.wrap(myArray);
            
            window.deferredContext = deferred.getContext();
            
            console.log('myarray.def ' + typeof myArray.def);
            var livewrap = deferred.getContext();

            /*function insertionsort(wrap) {
                for(var i = 0; i < wrap.getLength(); i++) {
                    wrap.set('j', i);
                    while(wrap.get('j') > 0 && wrap.getItem(wrap.get('j') - 1) > wrap.getItem(wrap.get('j'))) {
                        //swap:
                        console.log('swapping');
                        wrap.set('temp', wrap.getItem(wrap.get('j')));
                        wrap.setItem(wrap.get('j'), wrap.getItem(wrap.get('j') - 1));
                        wrap.setItem(wrap.get('j') - 1, wrap.get('temp'));
                        wrap.set('swapped', true);
                        wrap.set('j', wrap.get('j') - 1);
                    }
                    wrap.range(0, i, 1); //show sorted portion of array
                }
                wrap.clearfocus();
                wrap.clearrange(1);
            }*/

            /*function insertionsort(wrap) {
                for(var i = 0; i < wrap.getLength(); i++) {
                    wrap('j', i);  
                    while(wrap('j') > 0 && wrap.getItem(wrap('j') - 1) > wrap.getItem(wrap('j'))) {
                        //swap:
                        wrap.log('swapping');
                        wrap('temp', wrap.getItem(wrap('j')));
                        wrap.setItem(wrap('j'), wrap.getItem(wrap('j') - 1));
                        wrap.setItem(wrap('j') - 1, wrap('temp'));
                        wrap('swapped', true);
                        wrap('j', wrap('j') - 1);
                    }
                    wrap.range(0, i, 1); //show sorted portion of array
                }
                wrap.clearfocus();
                wrap.clearrange(1);
            }*/
            
            function insertionsort() {
                testAlert.call(this, 'Beginning insertion sort.');
                for(var i = 0; i < this.getLength(); i++) {
                    this('j', i);  
                    while(this('j') > 0 && this.getItem(this('j') - 1) > this.getItem(this('j'))) {
                        //swap:
                        this.log('swapping');
                        this('temp', this.getItem(this('j')));
                        this.setItem(this('j'), this.getItem(this('j') - 1));
                        this.setItem(this('j') - 1, this('temp'));
                        this('swapped', true);
                        this('j', this('j') - 1);
                    }
                    this.range(0, i, 1); //show sorted portion of array
                }
                this.clearfocus();
                this.clearrange(1);
            }
            
            function testAlert(str) {
                this.falert(str);
            }
            
            function flagOddNumbers(wrap) {
                for(var i = 0; i < wrap.getLength(); i++) {
                    if(wrap.getItem(i) % 2 !== 0) {
                        wrap.leftTo(i);
                        wrap.flag(i);
                        wrap.set('j', 5);
                        wrap.get('j');
                    }
                }
            }

            function testOne(wrap) {
                /*wrap.flag(0);
                wrap.flag(1);
                wrap.flag(2);
                wrap.set('a', 4);
                wrap.leftTo(4);
                wrap.getItem(3);
                wrap.setItem(3, 5);
                wrap.leftTo(0);

                wrap.leftTo(0);/*@line 17*/

                wrap.log('wrap.length ' + wrap.getLength());
                console.log('wrap.length ' + wrap.getLength());
                for(var i = 0; i < wrap.getLength(); i++) {
                    wrap.flag(i);
                }
            }

            var oldArray = myArray.array.slice(0, myArray.array.length);
            //insertionsort(livewrap);
            //insertionsort.call(livewrap);
            //flagOddNumbers(livewrap);
            console.log(myArray.array);
            myArray.array = oldArray;
            console.log(myArray.array);

           /* livewrap.on('end', function(){
                //alert('finished execution');
            });*/
            
            window.focus = function(i) {
                var wrap = S.live(myArray);
                wrap.focus(i);
                wrap.close();
                wrap.exec();
            }
            
            //window.lwrap = S.live(myArray);
            //deferred.exec();

        });
    </script>
</head>
<body>

</body>
</html>